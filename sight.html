<!DOCTYPE html>
<head>
	<link rel="stylesheet" href="sight.css">
	<nav class="naviBar">
		<a id="btn1" class="left" onclick="btnClick()">Button1</a>
		<a id="btn2" class="left" onclick="createItem()">Btn2</a>
		<a class="seperator"></a>
		<a id="btn3" class="right" onclick="createCat()">BTN03</a>
		<!--input class="searchBar" placeholder="Search..."-->
		<!--div id="submit" class="submitButton" onclick="test()"-->
		<a id="btn4" class="right" onclick="addCategoryForm()">+</a>
	</nav>
	<script>
		function btnClick() {
			const a = document.createElement("p");
			a.textContent = "button press";
			document.getElementById("content").appendChild(a);
		}
		function createItemOld() {
			const newItem = document.createElement("div");
			newItem.className = "item";

			const itemTitle = document.createElement("a");
			itemTitle.className = "itemTitle";
			const itemDesc = document.createElement("a");
			itemDesc.className = "desc";

			newItem.appendChild(itemTitle);
			newItem.appendChild(itemDesc);

			document.getElementById("content").appendChild(newItem);
		}

		function createCat() {
			const newCat = document.createElement("div");
			newCat.className = "category";

			const newCatTitle = document.createElement("a");
			newCatTitle.text = "fhjnkdshnfgkjadhngkd";
			newCatTitle.className = "catTitle";

			const newItem = document.createElement("div");
			newItem.className = "item itemGray";

			const itemTitle = document.createElement("a");
			itemTitle.className = "itemTitle";
			itemTitle.text = "jfiodasjfgojgo";
			const itemDesc = document.createElement("a");
			itemDesc.text = "fjkidklajglas";
			itemDesc.className = "desc";

			newItem.appendChild(itemTitle);

			newItem.appendChild(itemDesc);

			newCat.append(newCatTitle);
			newCat.append(newItem);

			// add line seperator
			const lineSeperator = document.createElement("hr");
			lineSeperator.className = "seperator";

			
			const container = document.getElementById("content");
			container.appendChild(newCat);
			container.appendChild(lineSeperator);
		}
		
		function hideForm(elem) {
			document.body.removeChild(elem);
		}
		
		function addCategoryForm() {
			const background = document.createElement("div");
			background.className = "addCatFormPopupBackground";
			document.body.appendChild(background);
			document.body.style.overflow = "hidden";

			background.addEventListener("click", function() {
				document.body.removeChild(background);
				document.body.removeChild(form);
				document.body.style.overflow = "auto";
			});

			const form = document.createElement("div");
			form.className = "addCatFormPopup";
			document.body.appendChild(form);

			const createCatBtn = document.createElement("a");
			createCatBtn.className = addBtn;
			createCatBtn.text = "+";

			document.getElementById("content").appendChild(createCatBtn);

		}

		function closeAddForm() {

		}

		// sep

		function dropdownCatAddForm(btnContainer) {
			// const container = document.getElementById("content");
			const element = document.querySelector(".addCatFormContainer");

			// remove plus icon
			const plusIcon = document.body.querySelector(".plus");
			btnContainer.removeChild(plusIcon);

			// resize btn
			btnContainer.classList.toggle("addCatFormContainerExpanded");

			setTimeout(function(){
				const formTitle = document.createElement("a");
				formTitle.className = "addCatFormTitle";
				formTitle.text = "Create category";

				// change styling for consistancy?
				const closeBtn = document.createElement("a");
				closeBtn.className = "closeBtn";
				closeBtn.text = "";

				// cat form
				const catNameInput = document.createElement("input");
				catNameInput.className = "catNameInput";
				catNameInput.type = "text";
				catNameInput.name = "catName";
				catNameInput.placeholder = "Enter the name of the category";
				const catNameSubmit = document.createElement("input");
				catNameSubmit.className = "catNameSubmitButton";
				catNameSubmit.type = "submit";
				catNameSubmit.value = "";

				catNameSubmit.addEventListener("click", function() {
					if (catNameInput.value) {
						createCategory(catNameInput.value, "test desc");
						appendCatAddBtn();
					} else {
						catNameInput.focus();
					}					
				});

				const closeFormBtn = document.createElement("div");
				closeFormBtn.className = "catNameSubmitButton";
				closeFormBtn.value = "X";

				closeFormBtn.addEventListener("click", function() {
					appendCatAddBtn();
				});

				// append to doc
				btnContainer.appendChild(catNameInput);
				btnContainer.appendChild(catNameSubmit);
				btnContainer.appendChild(closeFormBtn);

				// focus on input field to allow input from btn press
				catNameInput.focus();
			}, 100)

		}

		function dropdownCatAddFormAlt(btnContainer) {
			const container = document.getElementById("content");

			// remove button
			container.removeChild(btnContainer);

			// form container
			const formContainer = document.createElement("div");
			formContainer.className = "addCatFormContainer";

			const formTitle = document.createElement("a");
			formTitle.className = "addCatFormTitle";
			formTitle.text = "Create category";

				// to remove
			const closeBtn = document.createElement("a");
			closeBtn.className = "closeBtn";
			closeBtn.text = "X";

			const catNameInput = document.createElement("input");
			catNameInput.className = "catNameInput";
			const catNameSubmit = document.createElement("div");
			catNameSubmit.className = "catNameSubmitButton";

			// append to doc
			formContainer.append(formTitle);
			formContainer.append(closeBtn);
			formContainer.appendChild(catNameInput);
			formContainer.appendChild(catNameSubmit);
			container.appendChild(formContainer);
		}

		function appendCatAddBtn() {
			const contentContainer = document.getElementById("content");

			// re-place the add category btn so that it appears after the other elements
			const catFormContainer = document.body.querySelector(".addCatFormContainer");
			if (catFormContainer != null) {
				contentContainer.removeChild(catFormContainer);
			}		

			const btnContainer = document.createElement("div");
			btnContainer.className = "addCatFormContainer";
			btnContainer.addEventListener("click", function() {
				dropdownCatAddForm(btnContainer)
			});

			const plusIcon = document.createElement("a");
			plusIcon.className = "plus";
			plusIcon.textContent = "+";

			btnContainer.appendChild(plusIcon);
			contentContainer.appendChild(btnContainer);
		}

		function createCategory(title, desc) {

			const cat = document.createElement("div");
			cat.className = "category";

			const catTitle = document.createElement("a");
			catTitle.text = title;
			catTitle.className = "catTitle";

			cat.append(catTitle);

			// add line seperator
			const lineSeperator = document.createElement("hr");
			lineSeperator.className = "seperator";
			
			const contentContainer = document.getElementById("content");
			contentContainer.appendChild(cat);
			contentContainer.appendChild(lineSeperator);

			cat.addEventListener("click", function() {
				if (cat.querySelector(".catNameInput") == null) {
					const newEntry = document.createElement("input");
					newEntry.type = "text";
					newEntry.placeholder = "Enter the name of the new item";
					newEntry.className = "catNameInput";
					cat.appendChild(newEntry);

					newEntry.focus();

					newEntry.addEventListener("keypress", function(event) {
						if (event.key == 'Enter') {
							cat.removeChild(newEntry);
							console.log("fdkjafghaujksdfg");
						}
					});
				}
			});

		}

		// create item
		function createItem(parentDiv) {
			const itemContainer = document.createElement("div");
			itemContainer.className = "item itemGray";

			parentDiv.appendChild(itemContainer);
		}
	</script>
	<div id="content" class="contentContainer">
		<div id="test" class="category">
			<a class="catTitle">Category 1</a>
			<div class="item itemGray">
				<a class="itemTitle">dhjsafgjadsgfjasdk</a>
				<a class="itemTitle">Item title 1</a>
				<a class="itemDesc">This is the items description</a>
				<div class="itemCloseBtn">X</div>
			</div>
		</div>
		<hr class="seperator">
		<div class="category">
			<a class="catTitle">Category 2</a>
			<div class="item itemGray">
				<a class="itemTitle">Item title 2</a>
				<hr class="titleSeperator">
				<a class="desc">This is the items description</a>
				<div class="item itemWhite">
					<a class="itemTitle">Item title 1 layer 2</a>
					<hr class="titleSeperator">
					<a class="desc">This <br> is the items <br> description</a>
				</div>
				<div class="item itemWhite">
					<a class="itemTitle">Item title 3</a>
					<hr class="titleSeperator">
					<a class="desc">Item 3 description</a>
					<div class="item itemGray">
						<a class="itemTitle">Item title 1 layer 2</a>
						<hr class="titleSeperator">
						<a class="desc">This <br> is the items <br> description</a>
						<div class="item itemWhite">
							<a class="itemTitle">Item title 1 layer 2</a>
							<hr class="titleSeperator">
							<a class="desc">This <br> is the items <br> description</a>
						</div>
					</div>
				</div>
				<div class="item itemWhite">
					<a class="itemTitle">Item title 4</a>
					<hr class="titleSeperator">
					<a class="desc">Item 4 description</a>
				</div>
			</div>
			<div class="item itemGray">
				<a class="itemTitle">Item title 4</a>
			</div>
			<div class="item itemGray">
				<a class="itemTitle">Item title 5</a>
			</div>
		</div>
	</div>
	<script>
		appendCatAddBtn();
	</script>
</head>
